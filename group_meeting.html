
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dla najmłodszych - PogodnyWieczorek</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/all_styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
</head>
<body>

    <!-- Nawigacja -->
    <div id="navigation-placeholder"></div>

    <!-- About Section -->
    <section id="about" class="page-section background-image-section group_meeting-bg">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h2 class="section-heading text-uppercase">Spotkanie w grupie</h2>
                    <p class="text-muted"> 
                    Gry i zabawy, które świetnie sprawdzą się, gdy chcesz zintegrować swoją grupę lub dodać odrobinę rozrywki do wspólnego spotkania. 
                    Idealne na integrację, przełamanie lodów i dobrą zabawę!                        
                     </p>
                </div>
            </div>
        </div>
    </section>

       
   <!-- Menu -->
<div id="menu-placeholder"></div>
    
    <!-- Lista gier -->
    <div id="gameList" class="container my-5"></div>

    <!-- Stopka -->
<div id="footer-placeholder"></div>


    <!-- Modal -->
    <div id="game-modal-placeholder"></div>

    <!-- Skrypty -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="js/modal.js"></script>


<!-- Wczytywanie partials -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const loadPartial = (id, url) => {
        fetch(url)
            .then(res => res.text())
            .then(data => document.getElementById(id).innerHTML = data)
            .catch(err => console.error(`Błąd wczytywania ${url}:`, err));
    }
    loadPartial('navigation-placeholder','partials/navigation.html');
    loadPartial('menu-placeholder','partials/menu.html');
    loadPartial('game-modal-placeholder','partials/gameModal.html');
    loadPartial('footer-placeholder','partials/footer.html');
});
</script>

<!-- Wczytywanie gier -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const container = document.getElementById("gameList");

    fetch("games/games.json")
        .then(res => res.json())
        .then(games => {
            // Filtrujemy tylko gry z kategorii "groupMeeting"
            const groupMeetingGames = games.filter(game => 
                game.categories && game.categories.some(cat => cat.trim().toLowerCase() === "spotkanie w grupie")
            );

            if (groupMeetingGames.length === 0) {
                container.innerHTML = "<p class='text-center'>Brak gier w kategorii Spotkanie w grupie.</p>";
                return;
            }

            // Wyświetlanie tylko przefiltrowanych gier
            let html = '<div class="row">';
            groupMeetingGames.forEach(game => {
                html += `
                    <div class="col-md-4 mb-4">
                        <div class="card mb-4 h-100">
                            <img src="${game.image}" class="card-img-top" alt="${game.title}" style="height:200px; object-fit:cover;">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">${game.title}</h5>
                                <p class="card-text text-truncate-3">
                                    ${game.description}
                                </p>
                                <p class="card-text"><strong>Potrzebny sprzęt:</strong> ${game.equipment}</p>
                                <button class="btn btn-sm btn-outline-secondary read-more"
                                    data-title="${game.title}"
                                    data-description="${game.description}"
                                    data-image="${game.image}"
                                    data-equipment="${game.equipment}"
                                    data-variety="${game.variety || ''}"
                                    data-comment="${game.comment || ''}">
                                    Czytaj dalej
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            container.innerHTML = html;
        })
        .catch(err => console.error("Błąd wczytywania gier:", err));
});
</script>


<!-- Obsługa modala po kliknięciu w "Czytaj dalej" -->
<script>
document.addEventListener("click", function(event){
    if(event.target.classList.contains("read-more")){
        const button = event.target;
        const modal = $("#gameModal"); // musi istnieć w DOM (fetch partiala)

        // Wstawianie treści modala
        modal.find("#modal-title").text(button.dataset.title);
        modal.find("#modal-image").attr("src", button.dataset.image).attr("alt", button.dataset.title);
        modal.find("#modal-description").html(button.dataset.description);
        modal.find("#modal-equipment").text(button.dataset.equipment);

        // Urozmaicenie
        if(button.dataset.variety && button.dataset.variety.trim() !== "" && button.dataset.variety !== "null"){
            modal.find("#modal-variety-row").show();
            modal.find("#modal-variety").html(button.dataset.variety);
        } else {
            modal.find("#modal-variety-row").hide();
        }

        // Uwaga
        if(button.dataset.comment && button.dataset.comment.trim() !== "" && button.dataset.comment !== "null"){
            modal.find("#modal-comment-row").show();
            modal.find("#modal-comment").html(button.dataset.comment);
        } else {
            modal.find("#modal-comment-row").hide();
        }

        // Pokazanie modala
        modal.modal("show");

        // Ustawienie przewijalnosci modal-body
        modal.find('.modal-body').css({
            'max-height': '80vh',
            'overflow-y': 'auto'
        });

        //  Reset scrolla modal-body do góry po pełnym otwarciu
        modal.off('shown.bs.modal').on('shown.bs.modal', function () {
            $(this).find('.modal-body').scrollTop(0);
        });

    }
});
</script>
</body>
</html>

